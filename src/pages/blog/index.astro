---
import BaseLayout from "@layouts/BaseLayout.astro";
import { getCollection } from "astro:content";
import BlogTop from "@components/markdownSet/BlogTop.astro";
import Footer from "@components/common/Footer.astro";
import BlogContent from "@components/markdownSet/BlogContent.astro"
import { BLOG_CATEGORY } from "src/consts";


const blogCategories = new Set(BLOG_CATEGORY.map(item => item.type));

const posts = await getCollection("blog", (item) => blogCategories.has(item.data.category));


const sortedPosts = posts.sort((a, b) => new Date(b.data.date).valueOf() - new Date(a.data.date).valueOf());
const recentPosts = sortedPosts.slice(0, 4);

const categoryPosts = BLOG_CATEGORY.map(item => ({
  posts: item.type === "all" ? sortedPosts : sortedPosts.filter(post => post.data.category === item.type),
  ...item,
}));


---

<BaseLayout
  title="Nacos 博客"
  description="探索Nacos 博客，了解服务发现和配置管理的最新资讯、教程和技术分析。"
>
  <!-- <BlogHeader categories={BLOG_CATEGORY} title="博客" href="/blog"/> -->
  <div class="w-full flex flex-col items-center">
    <!-- 博客观察：在云原生时代导航微服务。 -->
    <BlogTop
      title="Blog Insights:Navigating Microservices in the Cloud-Native Era."
      title="博客"
      type="home"
      category={BLOG_CATEGORY}
  />
    <BlogContent source="blog" recentPosts={recentPosts} categoryPosts={categoryPosts} />
    <Footer />
  </div>
</BaseLayout>
<style>
  main {
    width: 960px;
  }
</style>

