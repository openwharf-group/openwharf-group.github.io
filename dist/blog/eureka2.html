<!DOCTYPE html><html lang="en" data-theme="light" class="astro-37fxchfa"> <head><meta charset="utf-8"><meta name="viewport" content="width=device-width"><meta name="referrer" content="no-referrer"><meta name="generator" content="Astro v4.0.6"><title>Nacos Blog</title><style>.sl-markdown-content :not(h1,h2,h3,h4,h5,h6)+:is(h1,h2,h3,h4,h5,h6):not(:where(.not-content *)){margin-top:2.5rem;scroll-margin-top:4rem}.sl-markdown-content li+li:not(:where(.not-content *)),.sl-markdown-content dt+dt:not(:where(.not-content *)),.sl-markdown-content dt+dd:not(:where(.not-content *)),.sl-markdown-content dd+dd:not(:where(.not-content *)){margin-top:.25rem}.sl-markdown-content li>:last-child:not(li,ul,ol):not(a,strong,em,del,span,input,:where(.not-content *)){margin-bottom:1.25rem}.sl-markdown-content dt:not(:where(.not-content *)){font-weight:700}.sl-markdown-content dd:not(:where(.not-content *)){padding-inline-start:1rem}.sl-markdown-content :is(h1,h2,h3,h4,h5,h6):not(:where(.not-content *)){color:#f4f4f6;line-height:var(--sl-line-height-headings);font-weight:600}.sl-markdown-content :is(img,picture,video,canvas,svg,iframe):not(:where(.not-content *)){display:block;max-width:100%;height:auto}.sl-markdown-content h1:not(:where(.not-content *)){font-size:var(--sl-text-h1)}.sl-markdown-content h2:not(:where(.not-content *)){font-size:var(--sl-text-h2)}.sl-markdown-content h3:not(:where(.not-content *)){font-size:var(--sl-text-h3)}.sl-markdown-content h4:not(:where(.not-content *)){font-size:var(--sl-text-h4)}.sl-markdown-content h5:not(:where(.not-content *)){font-size:var(--sl-text-h5)}.sl-markdown-content h6:not(:where(.not-content *)){font-size:var(--sl-text-h6)}.sl-markdown-content a:not(:where(.not-content *)){color:var(--sl-color-text-accent)}.sl-markdown-content a:hover:not(:where(.not-content *)){color:var(--sl-color-white)}.sl-markdown-content code:not(:where(.not-content *)){background-color:var(--sl-color-bg-inline-code);margin-block:-.125rem;padding:.125rem .375rem;font-size:var(--sl-text-code-sm)}.sl-markdown-content :is(h1,h2,h3,h4,h5,h6) code{font-size:inherit}.sl-markdown-content pre:not(:where(.not-content *)){border:1px solid var(--sl-color-gray-5);padding:.75rem 1rem;font-size:var(--sl-text-code);-moz-tab-size:2;-o-tab-size:2;tab-size:2}.sl-markdown-content pre code:not(:where(.not-content *)){all:unset;font-family:var(--__sl-font-mono)}.sl-markdown-content blockquote:not(:where(.not-content *)){border-inline-start:1px solid var(--sl-color-gray-5);padding-inline-start:1rem}.sl-markdown-content table:not(:where(.not-content *)){display:block;overflow:auto;border-collapse:collapse}.sl-markdown-content tr:nth-child(2n):not(:where(.not-content *)){background-color:var(--sl-color-gray-7, var(--sl-color-gray-6))}.sl-markdown-content :is(th,td):not(:where(.not-content *)){border:1px solid var(--sl-color-hairline-light);padding:.375rem .8125rem}.sl-markdown-content hr:not(:where(.not-content *)){border:0;border-bottom:1px solid var(--sl-color-hairline)}.sl-markdown-content h2{line-height:3.5rem}main:where(.astro-bvzihdzo){width:calc(100% - 2em);max-width:100%;margin:0}.hero-image:where(.astro-bvzihdzo){width:100%}.hero-image:where(.astro-bvzihdzo) img:where(.astro-bvzihdzo){display:block;margin:0 auto;border-radius:12px;box-shadow:var(--box-shadow)}.nacos-prose:where(.astro-bvzihdzo){width:90%;padding:1em;color:rgb(var(--gray-dark))}.title:where(.astro-bvzihdzo){margin-bottom:1em;padding:1em 0;text-align:center;line-height:1}.title:where(.astro-bvzihdzo) h1:where(.astro-bvzihdzo){margin:0 0 .5em}.date:where(.astro-bvzihdzo){margin-bottom:.5em;color:rgb(var(--gray))}.last-updated-on:where(.astro-bvzihdzo){font-style:italic}
</style>
<link rel="stylesheet" href="/_astro/index.zJXWWNOD.css" />
<style>@media (max-width: 36rem){html{font-size:12px}}
</style><script type="module" src="/_astro/hoisted.OxAi4q7n.js"></script>
<script type="module" src="/_astro/page.36aCzv65.js"></script></head> <body class="astro-37fxchfa"> <header-layout class="header bg-gray-14 relative astro-3ef6ksr2" style="position: sticky; height: 4rem; --justifyContent: space-between;"> <div data-modal-panel class="modal-panel hidden h-screen absolute left-0 right-0 top-0 astro-3ef6ksr2" style="--justifyContent: space-between;"></div> <div style="height: 4rem; --justifyContent: space-between;" class="nav bg-gray-14 relative top-0 right-0 bottom-0 left-0 flex items-center justify-between astro-3ef6ksr2"> <!-- logo --> <a href="/" class="astro-3ef6ksr2" style="--justifyContent: space-between;"> <img class="logo astro-3ef6ksr2" src="/nacos_white.png" style="--justifyContent: space-between;"> </a> <!-- 菜单 --> <div class="pc_nav_menu flex h-full items-center astro-3ef6ksr2" style="--justifyContent: space-between;"> <div class="menu-item h-full flex items-center cursor-pointer text-gray-06 text-sm px-4 astro-3ef6ksr2" style="--justifyContent: space-between;"> <div data-docs class="h-full flex items-center p-0.5 astro-3ef6ksr2" style="--justifyContent: space-between;"> <span class="title astro-3ef6ksr2" style="--justifyContent: space-between;">DOCS</span> <svg data-docs-arrow class="arrow ml-2 astro-3ef6ksr2" width="10" height="7" viewBox="0 0 10 7" fill="none" xmlns="http://www.w3.org/2000/svg" style="--justifyContent: space-between;"> <path d="M8.05264 2L5.05264 5.00649L2.05264 2" stroke="#a3a6b3" stroke-width="1.25" stroke-linecap="square" class="astro-3ef6ksr2" style="--justifyContent: space-between;"></path> </svg> </div> <div data-docs-dropdown style="top: 4rem; --justifyContent: space-between;" class="dropdown-panel bg-gray-14 hidden invisible opacity-0 absolute left-0 right-0 astro-3ef6ksr2"> <div class="flex pb-10 pt-14 px-24 astro-3ef6ksr2" style="--justifyContent: space-between;"> <div class="shortcut-menu flex flex-col px-7 mr-14 astro-3ef6ksr2" style="--justifyContent: space-between;"> <span class="text-xs text-gray-10 mb-2 astro-3ef6ksr2" style="--justifyContent: space-between;">Documentation</span> <a href="/docs/what-is-nacos" class="flex items-center mt-3 cursor-pointer astro-3ef6ksr2" style="--justifyContent: space-between;"> <span class="text-sm text-gray-02 astro-3ef6ksr2" style="--justifyContent: space-between;">1.x</span> </a><a href="/docs/v2/what-is-nacos" class="flex items-center mt-3 cursor-pointer astro-3ef6ksr2" style="--justifyContent: space-between;"> <span class="text-sm text-gray-02 astro-3ef6ksr2" style="--justifyContent: space-between;">2.x</span> </a> </div> </div> </div> </div> <span class="text-gray-06 text-xs astro-3ef6ksr2" style="--justifyContent: space-between;">|</span> <div class="menu-item h-full flex items-center cursor-pointer text-gray-06 text-sm px-4 astro-3ef6ksr2" style="--justifyContent: space-between;"> <div data-nacos-cloud class="h-full flex items-center p-0.5 astro-3ef6ksr2" style="--justifyContent: space-between;"> <span class="title astro-3ef6ksr2" style="--justifyContent: space-between;">NACOS CLOUD</span> </div> </div> <span class="text-gray-06 text-xs astro-3ef6ksr2" style="--justifyContent: space-between;">|</span> <div class="menu-item h-full flex items-center cursor-pointer text-gray-06 text-sm px-4 astro-3ef6ksr2" style="--justifyContent: space-between;"> <div data-community class="h-full flex items-center p-0.5 astro-3ef6ksr2" style="--justifyContent: space-between;"> <span class="title astro-3ef6ksr2" style="--justifyContent: space-between;">COMMUNITY</span> <svg data-community-arrow class="arrow ml-2 astro-3ef6ksr2" width="10" height="7" viewBox="0 0 10 7" fill="none" xmlns="http://www.w3.org/2000/svg" style="--justifyContent: space-between;"> <path d="M8.05264 2L5.05264 5.00649L2.05264 2" stroke="#a3a6b3" stroke-width="1.25" stroke-linecap="square" class="astro-3ef6ksr2" style="--justifyContent: space-between;"></path> </svg> </div> <div data-community-dropdown style="top: 4rem; --justifyContent: space-between;" class="dropdown-panel bg-gray-14 hidden invisible opacity-0 absolute left-0 right-0 z-50 astro-3ef6ksr2"> <div class="flex pb-10 pt-14 px-24 justify-center astro-3ef6ksr2" style="--justifyContent: space-between;"> <div class="flex mr-32 astro-3ef6ksr2" style="--justifyContent: space-between;"> <div class="shortcut-menu flex flex-col px-7 mr-14 astro-3ef6ksr2" style="--justifyContent: space-between;"> <span class="text-xs text-gray-10 mb-2 astro-3ef6ksr2" style="--justifyContent: space-between;">COMMUNITY</span> <a class="text-sm text-gray-02 mt-3  astro-3ef6ksr2" href="/" style="--justifyContent: space-between;">Contact</a><a class="text-sm text-gray-02 mt-3  astro-3ef6ksr2" href="/" style="--justifyContent: space-between;">Report</a><a class="text-sm text-gray-02 mt-3  astro-3ef6ksr2" href="/" style="--justifyContent: space-between;">Contribute</a><a class="text-sm text-gray-02 mt-3  astro-3ef6ksr2" href="/" style="--justifyContent: space-between;">Stars</a> </div> <div class="shortcut-menu flex flex-col px-7 mr-14 astro-3ef6ksr2" style="--justifyContent: space-between;"> <span class="text-xs text-gray-10 mb-2 astro-3ef6ksr2" style="--justifyContent: space-between;">EVENTS</span> <a class="text-sm text-gray-02 mt-3  astro-3ef6ksr2" href="/" style="--justifyContent: space-between;">Events</a><a class="text-sm text-gray-02 mt-3  astro-3ef6ksr2" href="/" style="--justifyContent: space-between;">News</a><a class="text-sm text-gray-02 mt-3  astro-3ef6ksr2" href="/" style="--justifyContent: space-between;">Meetup</a> <span class="text-xs text-gray-10 mb-2 mt-10 astro-3ef6ksr2" style="--justifyContent: space-between;">Resources</span> <a class="text-sm text-gray-02 mt-3  astro-3ef6ksr2" href="/blog" style="--justifyContent: space-between;">Blog</a><a class="text-sm text-gray-02 mt-3  astro-3ef6ksr2" href="/docs/ebook/iez8a4" style="--justifyContent: space-between;">E-book</a><a class="text-sm text-gray-02 mt-3  astro-3ef6ksr2" href="/download/nacos-service" style="--justifyContent: space-between;">Download</a> </div> </div> <div class="flex astro-3ef6ksr2" style="--justifyContent: space-between;"> <div class="shortcut-card bg-gray-13 rounded-2xl p-2 flex flex-col w-64 ml-4 astro-3ef6ksr2" style="--justifyContent: space-between;"> <img class=" astro-3ef6ksr2" src="/left-shortcut.png" style="--justifyContent: space-between;"> <div class="text-blue-01 text-sm mt-3 line-clamp-3 h-16 astro-3ef6ksr2" style="--justifyContent: space-between;">Key to service-centric (for example microservice or cloud-native) architectures.</div> <button class="btn mt-8 w-fit text-xs bg-gray-12 text-gray-01 border-0 rounded-3xl astro-3ef6ksr2" style="--justifyContent: space-between;">READ ARTICLE</button> </div><div class="shortcut-card bg-gray-13 rounded-2xl p-2 flex flex-col w-64 ml-4 astro-3ef6ksr2" style="--justifyContent: space-between;"> <img class=" astro-3ef6ksr2" src="/right-shortcut.png" style="--justifyContent: space-between;"> <div class="text-blue-01 text-sm mt-3 line-clamp-3 h-16 astro-3ef6ksr2" style="--justifyContent: space-between;">An easy-to-use platform for building cloud native applications</div> <button class="btn mt-8 w-fit text-xs bg-gray-12 text-gray-01 border-0 rounded-3xl astro-3ef6ksr2" style="--justifyContent: space-between;">READ ARTICLE</button> </div> </div> </div> </div> </div> <span class="text-gray-06 text-xs astro-3ef6ksr2" style="--justifyContent: space-between;">|</span> <div class="menu-item h-full flex items-center cursor-pointer text-gray-06 text-sm px-4 astro-3ef6ksr2" style="--justifyContent: space-between;"> <div data-demo class="h-full flex items-center p-0.5 astro-3ef6ksr2" style="--justifyContent: space-between;"> <span class="title astro-3ef6ksr2" style="--justifyContent: space-between;">DEMO</span> </div> </div> </div> <!-- 右侧菜单 --> <div class="astro-3ef6ksr2" style="--justifyContent: space-between;">  </div> <!-- 小屏适配 --> <div class="mobile_nav_menu hidden cursor-pointer astro-3ef6ksr2" style="--justifyContent: space-between;"> <button class="text-gray-01 bg-gray-14 flex items-center astro-3ef6ksr2" style="--justifyContent: space-between;"> <svg class="cursor-pointer icon ml-4 astro-3ef6ksr2" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6304" width="24" height="24" style="--justifyContent: space-between;"><path d="M192.037 287.953h640.124c17.673 0 32-14.327 32-32s-14.327-32-32-32H192.037c-17.673 0-32 14.327-32 32s14.327 32 32 32zM832.161 479.169H438.553c-17.673 0-32 14.327-32 32s14.327 32 32 32h393.608c17.673 0 32-14.327 32-32s-14.327-32-32-32zM832.161 735.802H192.037c-17.673 0-32 14.327-32 32s14.327 32 32 32h640.124c17.673 0 32-14.327 32-32s-14.327-32-32-32zM319.028 351.594l-160 160 160 160z" fill="#f4f4f6" p-id="6305" class="astro-3ef6ksr2" style="--justifyContent: space-between;"></path></svg> </button> </div> <!-- 移动端导航菜单 --> <div data-mobile-menu class="overflow-hidden hidden flex flex-col w-screen bg-gray-01 h-screen absolute left-0 right-0 top-0 astro-3ef6ksr2" style="--justifyContent: space-between;"> <!-- 顶部logo --> <div style="height: 4rem; --justifyContent: space-between;" class="mobile_nav bg-gray-14 px-8 flex items-center justify-start astro-3ef6ksr2"> <a href="/" class="astro-3ef6ksr2" style="--justifyContent: space-between;"> <img class="logo astro-3ef6ksr2" src="/nacos_white.png" style="--justifyContent: space-between;"> </a> <div class="menu_close flex items-center cursor-pointer astro-3ef6ksr2" style="--justifyContent: space-between;"> <button class="text-gray-01 bg-gray-14 flex items-center astro-3ef6ksr2" style="--justifyContent: space-between;"> <svg class="cursor-pointer icon ml-4 astro-3ef6ksr2" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7494" id="mx_n_1702523741163" width="24" height="24" style="--justifyContent: space-between;"><path d="M192.037 287.953h640.124c17.673 0 32-14.327 32-32s-14.327-32-32-32H192.037c-17.673 0-32 14.327-32 32s14.327 32 32 32zM192.028 543.17h393.608c17.673 0 32-14.327 32-32s-14.327-32-32-32H192.028c-17.673 0-32 14.327-32 32s14.327 32 32 32zM832.161 735.802H192.037c-17.673 0-32 14.327-32 32s14.327 32 32 32h640.124c17.673 0 32-14.327 32-32s-14.327-32-32-32zM705.162 671.594l160-160-160-160z" fill="#f4f4f6" p-id="7495" class="astro-3ef6ksr2" style="--justifyContent: space-between;"></path></svg> </button> </div> </div> <div data-mobile-menu-list class="w-full pl-8 astro-3ef6ksr2" style="--justifyContent: space-between;"> <ul class="list-none pl-0 astro-3ef6ksr2" style="--justifyContent: space-between;"> <li class="astro-3ef6ksr2" style="--justifyContent: space-between;"> <div mobile-menu-expand-docs class="astro-3ef6ksr2" style="--justifyContent: space-between;"> <button class="pl-0 mt-4 bg-gray-01 flex items-center cursor-pointer astro-3ef6ksr2" style="--justifyContent: space-between;"> <span class="mr-2 text-gray-14 text-sm astro-3ef6ksr2" style="--justifyContent: space-between;">DOCS</span> <svg width="12" height="12" viewBox="0 0 9 14" fill="none" xmlns="http://www.w3.org/2000/svg" class="astro-3ef6ksr2" style="--justifyContent: space-between;"><path d="M1 1L7 7L1 13" stroke="#2e3038" stroke-width="2" class="astro-3ef6ksr2" style="--justifyContent: space-between;"></path></svg> </button> </div> <div mobile-menu-expand-content-docs class="px-8 hidden invisible opacity-0 w-screen bg-gray-01 absolute left-0 right-0 top-16 astro-3ef6ksr2" style="--justifyContent: space-between;"> <div mobile-menu-fold-docs class="flex items-center pt-8 pb-4 astro-3ef6ksr2" style="--justifyContent: space-between;"> <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" class="rotate-180 mr-4 astro-3ef6ksr2" fill="none" viewBox="0 0 9 14" stroke="#2e3038" style="--justifyContent: space-between;"> <path stroke-width="2" d="M1 1L7 7L1 13" class="astro-3ef6ksr2" style="--justifyContent: space-between;"></path> </svg> <span class="text-gray-14 text-sm astro-3ef6ksr2" style="--justifyContent: space-between;">DOCS</span> </div> <div class="divider divider-vertical bg-gray-01 h-[0.05rem] astro-3ef6ksr2" style="--justifyContent: space-between;"></div> <div class="astro-3ef6ksr2" style="--justifyContent: space-between;"> <span class="text-xs text-gray-07 astro-3ef6ksr2" style="--justifyContent: space-between;">Documentation</span> <ul class="pl-0 list-none astro-3ef6ksr2" style="--justifyContent: space-between;"> <a href="/docs/what-is-nacos" class="flex items-center mt-3 cursor-pointer astro-3ef6ksr2" style="--justifyContent: space-between;"> <li class="text-sm text-gray-14 astro-3ef6ksr2" style="--justifyContent: space-between;">1.x</li> </a><a href="/docs/v2/what-is-nacos" class="flex items-center mt-3 cursor-pointer astro-3ef6ksr2" style="--justifyContent: space-between;"> <li class="text-sm text-gray-14 astro-3ef6ksr2" style="--justifyContent: space-between;">2.x</li> </a> </ul> </div> </div> </li> <li class="mt-4 astro-3ef6ksr2" style="--justifyContent: space-between;"> <a href="/nacosCloud" class="text-gray-14 text-sm astro-3ef6ksr2" style="--justifyContent: space-between;">NACOS CLOUD</a> </li> <li class="astro-3ef6ksr2" style="--justifyContent: space-between;"> <div mobile-menu-expand-com class="astro-3ef6ksr2" style="--justifyContent: space-between;"> <button class="pl-0 mt-4 bg-gray-01 flex items-center cursor-pointer astro-3ef6ksr2" style="--justifyContent: space-between;"> <span class="mr-2 text-gray-14 text-sm astro-3ef6ksr2" style="--justifyContent: space-between;">COMMUNITY</span> <svg width="12" height="12" viewBox="0 0 9 14" fill="none" xmlns="http://www.w3.org/2000/svg" class="astro-3ef6ksr2" style="--justifyContent: space-between;"><path d="M1 1L7 7L1 13" stroke="#2e3038" stroke-width="2" class="astro-3ef6ksr2" style="--justifyContent: space-between;"></path></svg> </button> </div> <div mobile-menu-expand-content-com class="px-8 hidden invisible opacity-0 w-screen bg-gray-01 absolute left-0 right-0 top-16 astro-3ef6ksr2" style="--justifyContent: space-between;"> <div mobile-menu-fold-com class="flex items-center pt-8 pb-4 astro-3ef6ksr2" style="--justifyContent: space-between;"> <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" class="rotate-180 mr-4 astro-3ef6ksr2" fill="none" viewBox="0 0 9 14" stroke="#2e3038" style="--justifyContent: space-between;"> <path stroke-width="2" d="M1 1L7 7L1 13" class="astro-3ef6ksr2" style="--justifyContent: space-between;"></path> </svg> <span class="text-gray-14 text-sm astro-3ef6ksr2" style="--justifyContent: space-between;">COMMUNITY</span> </div> <div class="divider divider-vertical bg-gray-01 h-[0.05rem] astro-3ef6ksr2" style="--justifyContent: space-between;"></div> <div class="mobile_menu_community flex justify-between astro-3ef6ksr2" style="--justifyContent: space-between;"> <div class="mb-6 astro-3ef6ksr2" style="--justifyContent: space-between;"> <span class="text-xs text-gray-07 astro-3ef6ksr2" style="--justifyContent: space-between;">COMMUNITY</span> <ul class="pl-0 list-none astro-3ef6ksr2" style="--justifyContent: space-between;"> <a href="/" class="astro-3ef6ksr2" style="--justifyContent: space-between;"> <li class="text-sm text-gray-14 mt-2 cursor-pointer astro-3ef6ksr2" style="--justifyContent: space-between;"> Contact </li> </a><a href="/" class="astro-3ef6ksr2" style="--justifyContent: space-between;"> <li class="text-sm text-gray-14 mt-2 cursor-pointer astro-3ef6ksr2" style="--justifyContent: space-between;"> Report </li> </a><a href="/" class="astro-3ef6ksr2" style="--justifyContent: space-between;"> <li class="text-sm text-gray-14 mt-2 cursor-pointer astro-3ef6ksr2" style="--justifyContent: space-between;"> Contribute </li> </a><a href="/" class="astro-3ef6ksr2" style="--justifyContent: space-between;"> <li class="text-sm text-gray-14 mt-2 cursor-pointer astro-3ef6ksr2" style="--justifyContent: space-between;"> Stars </li> </a> </ul> </div> <div class="mb-6 astro-3ef6ksr2" style="--justifyContent: space-between;"> <span class="text-xs text-gray-07 astro-3ef6ksr2" style="--justifyContent: space-between;">EVENTS</span> <ul class="pl-0 list-none astro-3ef6ksr2" style="--justifyContent: space-between;"> <a href="/" class="astro-3ef6ksr2" style="--justifyContent: space-between;"> <li class="text-sm text-gray-14 mt-2 cursor-pointer astro-3ef6ksr2" style="--justifyContent: space-between;"> Events </li> </a><a href="/" class="astro-3ef6ksr2" style="--justifyContent: space-between;"> <li class="text-sm text-gray-14 mt-2 cursor-pointer astro-3ef6ksr2" style="--justifyContent: space-between;"> News </li> </a><a href="/" class="astro-3ef6ksr2" style="--justifyContent: space-between;"> <li class="text-sm text-gray-14 mt-2 cursor-pointer astro-3ef6ksr2" style="--justifyContent: space-between;"> Meetup </li> </a> </ul> </div> <div class="mb-6 astro-3ef6ksr2" style="--justifyContent: space-between;"> <span class="text-xs text-gray-07 astro-3ef6ksr2" style="--justifyContent: space-between;">Resources</span> <ul class="pl-0 list-none astro-3ef6ksr2" style="--justifyContent: space-between;"> <a href="/blog" class="astro-3ef6ksr2" style="--justifyContent: space-between;"> <li class="text-sm text-gray-14 mt-2 cursor-pointer astro-3ef6ksr2" style="--justifyContent: space-between;"> Blog </li> </a><a href="/docs/ebook/iez8a4" class="astro-3ef6ksr2" style="--justifyContent: space-between;"> <li class="text-sm text-gray-14 mt-2 cursor-pointer astro-3ef6ksr2" style="--justifyContent: space-between;"> E-book </li> </a><a href="/download/nacos-service" class="astro-3ef6ksr2" style="--justifyContent: space-between;"> <li class="text-sm text-gray-14 mt-2 cursor-pointer astro-3ef6ksr2" style="--justifyContent: space-between;"> Download </li> </a> </ul> </div> </div> </div> </li> <li class="mt-4 astro-3ef6ksr2" style="--justifyContent: space-between;"> <a href="/" class="text-gray-14 text-sm astro-3ef6ksr2" style="--justifyContent: space-between;">DEMO</a> </li> </ul> </div> </div> </div> </header-layout>    <div class="bg-gray-14 "> <div class="w-[70%] inline-block"> <div class="sl-markdown-content bg-gray-14 text-gray-01 astro-bvzihdzo"> <div class="hero-image  astro-bvzihdzo">  </div> <div class="nacos-prose mx-auto astro-bvzihdzo"> <div class="title astro-bvzihdzo"> <div class="date astro-bvzihdzo"> 2019-08-22  </div> <h1 class="astro-bvzihdzo">Eureka 2.0 开源工作宣告停止？别担心，ANS 即将 C位强势出道！</h1> <hr class="astro-bvzihdzo"> </div>  <p>近日，Netflix 公司在 github 上公告 Eureka 2.0 开源工作停止，继续使用风险自负。这一消息在spring cloud 开发者中引起了一些担心和忧虑。</p>
<p>同时在阿里巴巴正式宣布其开源计划， 将通过 Nacos 项目将阿里巴巴在建设共享服务体系中使用的服务发现、配置及服务管理平台贡献给开源社区，通过打造 Dubbo + Nacos 的经典组合进一步释放 Dubbo 在云原生及 Service Mesh 时代中，在大规模微服务治理、流量治理、服务集成与服务共享等服务平台能力建设上的威力，同时 Nacos 会非常关注对主流开源社区，如 Spring Cloud 和 Kubernetes 云原生体系的无缝对接与支持。</p>
<p>ANS (alibaba naming service) 是 nacos 组件中的服务发现部分。开源流程正在紧张地进行中。同时 ANS 与 spring cloud 结合的 spring cloud starter ans 也将同时开源到 spring cloud <a href="https://github.com/spring-cloud-incubator/spring-cloud-alibabacloud" rel="noopener noreferrer" target="_blank">官方孵化器</a>。</p>
<p>ANS 同样也支持 spring cloud 应用的服务注册与发现，同时默认集成了负载均衡组件 Ribbon，Eureka 用户可以简单地通过替换 maven 项目中 pom.xml 文件中的依赖来实现无缝迁移。</p>
<p>想抢先体验？来试试商业版的 EDAS Ans starter 吧！</p>
<h2 id="快速开始">快速开始</h2>
<h3 id="服务提供者">服务提供者</h3>
<ol>
<li>
<p>创建一个 Spring Cloud 工程，命名为 service-provider。这里我们以 spring boot 1.5.8 和 spring cloud Dalston.SR4 为例。在 pom.xml 中引入需要的依赖内容。<br>
其他版本如 spring boot 2 + spring cloud Finchley 也同样支持，请您自行修改版本号和替换相应的组件依赖。</p>
<div class="expressive-code"><link rel="stylesheet" href="/_astro/ec.t1efu.css"><script type="module" src="/_astro/ec.sgewm.js"></script><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#e1e4e8"> &#x3C;parent></span></div><div class="ec-line"><span style="--0:#e1e4e8">   &#x3C;groupId>org.springframework.boot&#x3C;/groupId></span></div><div class="ec-line"><span style="--0:#e1e4e8">   &#x3C;artifactId>spring-boot-starter-parent&#x3C;/artifactId></span></div><div class="ec-line"><span style="--0:#e1e4e8">   &#x3C;version>1.5.8.RELEASE&#x3C;/version></span></div><div class="ec-line"><span style="--0:#e1e4e8">   &#x3C;relativePath/></span></div><div class="ec-line"><span style="--0:#e1e4e8"> &#x3C;/parent></span></div><div class="ec-line">
</div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#e1e4e8"> &#x3C;dependencies></span></div><div class="ec-line"><span style="--0:#e1e4e8">   &#x3C;dependency></span></div><div class="ec-line"><span style="--0:#e1e4e8">     &#x3C;groupId>com.alibaba.cloud&#x3C;/groupId></span></div><div class="ec-line"><span style="--0:#e1e4e8">     &#x3C;artifactId>spring-cloud-starter-ans&#x3C;/artifactId></span></div><div class="ec-line"><span style="--0:#e1e4e8">     &#x3C;version>1.1.3&#x3C;/version></span></div><div class="ec-line"><span style="--0:#e1e4e8">   &#x3C;/dependency></span></div><div class="ec-line"><span style="--0:#e1e4e8">   &#x3C;dependency></span></div><div class="ec-line"><span style="--0:#e1e4e8">     &#x3C;groupId>com.alibaba.cloud&#x3C;/groupId></span></div><div class="ec-line"><span style="--0:#e1e4e8">     &#x3C;artifactId>spring-cloud-alibaba-edas-starter&#x3C;/artifactId></span></div><div class="ec-line"><span style="--0:#e1e4e8">     &#x3C;version>1.1.3&#x3C;/version></span></div><div class="ec-line"><span style="--0:#e1e4e8">   &#x3C;/dependency></span></div><div class="ec-line"><span style="--0:#e1e4e8"> &#x3C;/dependencies></span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#e1e4e8"> &#x3C;dependencyManagement></span></div><div class="ec-line"><span style="--0:#e1e4e8">   &#x3C;dependencies></span></div><div class="ec-line"><span style="--0:#e1e4e8">     &#x3C;dependency></span></div><div class="ec-line"><span style="--0:#e1e4e8">       &#x3C;groupId>org.springframework.cloud&#x3C;/groupId></span></div><div class="ec-line"><span style="--0:#e1e4e8">       &#x3C;artifactId>spring-cloud-dependencies&#x3C;/artifactId></span></div><div class="ec-line"><span style="--0:#e1e4e8">       &#x3C;version>Dalston.SR4&#x3C;/version></span></div><div class="ec-line"><span style="--0:#e1e4e8">       &#x3C;type>pom&#x3C;/type></span></div><div class="ec-line"><span style="--0:#e1e4e8">       &#x3C;scope>import&#x3C;/scope></span></div><div class="ec-line"><span style="--0:#e1e4e8">     &#x3C;/dependency></span></div><div class="ec-line"><span style="--0:#e1e4e8">   &#x3C;/dependencies></span></div><div class="ec-line"><span style="--0:#e1e4e8"> &#x3C;/dependencyManagement></span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code=" <parent>   <groupId>org.springframework.boot</groupId>   <artifactId>spring-boot-starter-parent</artifactId>   <version>1.5.8.RELEASE</version>   <relativePath/> </parent> <dependencies>   <dependency>     <groupId>com.alibaba.cloud</groupId>     <artifactId>spring-cloud-starter-ans</artifactId>     <version>1.1.3</version>   </dependency>   <dependency>     <groupId>com.alibaba.cloud</groupId>     <artifactId>spring-cloud-alibaba-edas-starter</artifactId>     <version>1.1.3</version>   </dependency> </dependencies> <dependencyManagement>   <dependencies>     <dependency>       <groupId>org.springframework.cloud</groupId>       <artifactId>spring-cloud-dependencies</artifactId>       <version>Dalston.SR4</version>       <type>pom</type>       <scope>import</scope>     </dependency>   </dependencies> </dependencyManagement>"><div></div></button></div></figure></div>
</li>
<li>
<p>编码服务提供端的启动类，其中 @EnableDiscoveryClient 注解表明此应用需开启服务注册与发现功能。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#e1e4e8"> @SpringBootApplication</span></div><div class="ec-line"><span style="--0:#e1e4e8"> @EnableDiscoveryClient</span></div><div class="ec-line"><span style="--0:#e1e4e8"> public class ServerApplication {</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#e1e4e8">     public static void main(String[] args) {</span></div><div class="ec-line"><span style="--0:#e1e4e8">         SpringApplication.run(ServerApplication.class, args);</span></div><div class="ec-line"><span style="--0:#e1e4e8">     }</span></div><div class="ec-line"><span style="--0:#e1e4e8"> }</span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code=" @SpringBootApplication @EnableDiscoveryClient public class ServerApplication {     public static void main(String[] args) {         SpringApplication.run(ServerApplication.class, args);     } }"><div></div></button></div></figure></div>
</li>
<li>
<p>既然是服务提供者，所以我们还需要提供一个简单的服务。这里 EchoController 的逻辑很简单，将收到的参数回显给调用者。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#e1e4e8"> @RestController</span></div><div class="ec-line"><span style="--0:#e1e4e8"> public class EchoController {</span></div><div class="ec-line"><span style="--0:#e1e4e8">     @RequestMapping(value = "/echo/{string}", method = RequestMethod.GET)</span></div><div class="ec-line"><span style="--0:#e1e4e8">     public String echo(@PathVariable String string) {</span></div><div class="ec-line"><span style="--0:#e1e4e8">         return string;</span></div><div class="ec-line"><span style="--0:#e1e4e8">     }</span></div><div class="ec-line"><span style="--0:#e1e4e8"> }</span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code=" @RestController public class EchoController {     @RequestMapping(value = &#x22;/echo/{string}&#x22;, method = RequestMethod.GET)     public String echo(@PathVariable String string) {         return string;     } }"><div></div></button></div></figure></div>
</li>
<li>
<p>权限配置，配置阿里云账号的 AccessKey、SecretKey，以及 EDAS 的命名空间信息。</p>
<ol>
<li>
<p>配置阿里云 AccessKey 和 SecretKey</p>
<p>登陆 <a href="https://usercenter.console.aliyun.com/#/accesskey" rel="noopener noreferrer" target="_blank">阿里云AK管理控制台</a>。找到 <code dir="auto">用户信息管理</code> 下的 <code dir="auto">安全信息管理</code>。</p>
<p>复制 <code dir="auto">AccessKey ID</code> 和 <code dir="auto">Access Key Secret</code>，分别对应配置项中的 alibaba.cloud.access-key 和 alibaba.cloud.secret-key。</p>
<p>安全凭证信息格式如下：</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#e1e4e8"> alibaba.cloud.access-key=xxxxxxxxxx</span></div><div class="ec-line"><span style="--0:#e1e4e8"> alibaba.cloud.secret-key=xxxxxxxxxx</span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code=" alibaba.cloud.access-key=xxxxxxxxxx alibaba.cloud.secret-key=xxxxxxxxxx"><div></div></button></div></figure></div>
<p><img src="https://cdn.yuque.com/lark/0/2018/png/54319/1531104058520-831f4dba-6279-4bd3-9632-899d29830868.png" alt="2.png"></p>
</li>
<li>
<p>配置 EDAS 的命名空间</p>
<p>登录 <a href="https://edas.console.aliyun.com/#/home" rel="noopener noreferrer" target="_blank">EDAS 控制台</a>。未开通EDAS的用户需要先开通EDAS，<strong>EDAS 标准版促销进行中，每月仅需1元。</strong></p>
<p>在左侧导航栏中单击<strong>命名空间</strong>。在命名空间列表页面选择<strong>地域</strong>，并找到您想发布到的命名空间，复制其<strong>命名空间ID</strong>，对应配置项中的 <strong>alibaba.edas.namespace</strong>。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#e1e4e8"> alibaba.edas.namespace=xxxxxxxxxx</span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code=" alibaba.edas.namespace=xxxxxxxxxx"><div></div></button></div></figure></div>
<p><img src="https://cdn.yuque.com/lark/0/2018/png/54319/1531104049757-c3d2aefd-5d57-4434-a04f-2cd939cf58b0.png" alt="1.png"></p>
</li>
</ol>
</li>
<li>
<p>综上，我们的配置文件 application.properties 内容最后是这样的。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#e1e4e8"> spring.application.name=service-provider</span></div><div class="ec-line"><span style="--0:#e1e4e8"> server.port=18081</span></div><div class="ec-line"><span style="--0:#e1e4e8"> alibaba.cloud.access-key=xxxxxxxxxx</span></div><div class="ec-line"><span style="--0:#e1e4e8"> alibaba.cloud.secret-key=xxxxxxxxxx</span></div><div class="ec-line"><span style="--0:#e1e4e8"> alibaba.edas.namespace=cn-hangzhou</span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code=" spring.application.name=service-provider server.port=18081 alibaba.cloud.access-key=xxxxxxxxxx alibaba.cloud.secret-key=xxxxxxxxxx alibaba.edas.namespace=cn-hangzhou"><div></div></button></div></figure></div>
</li>
<li>
<p>启动 service-provider 服务，在 EDAS 页面查看服务注册的信息。</p>
<p>可以看到服务列表中已经存在的实例 service-provider，从详情页可以看到IP地址是本机的地址192.168.0.107,端口是 18081。</p>
<p><img src="https://cdn.yuque.com/lark/0/2018/jpeg/54319/1531104455581-1d9521aa-927e-4292-9d83-b1057ab67c02.jpeg" alt="3.JPG"></p>
<p><img src="https://cdn.yuque.com/lark/0/2018/png/54319/1531104077485-48d3d67b-584d-4729-aef2-2fbb64c0b846.png" alt="4.png"></p>
</li>
</ol>
<h3 id="服务消费者">服务消费者</h3>
<p>这个例子中，我们将不仅仅是演示服务发现的功能，同时还将演示 ANS 服务发现 与 RestTemplate、AsyncRestTemplate 和 FeignClient 这三个客户端是如何结合的。因为实际使用中，我们更多使用的是用这三个客户端进行服务调用。</p>
<ol>
<li>
<p>创建一个 Spring Cloud 工程，命名为 service-consumer。首先在 pom.xml 中引入需要的依赖内容：</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#e1e4e8"> &#x3C;parent></span></div><div class="ec-line"><span style="--0:#e1e4e8">   &#x3C;groupId>org.springframework.boot&#x3C;/groupId></span></div><div class="ec-line"><span style="--0:#e1e4e8">   &#x3C;artifactId>spring-boot-starter-parent&#x3C;/artifactId></span></div><div class="ec-line"><span style="--0:#e1e4e8">   &#x3C;version>1.5.8.RELEASE&#x3C;/version></span></div><div class="ec-line"><span style="--0:#e1e4e8">   &#x3C;relativePath/></span></div><div class="ec-line"><span style="--0:#e1e4e8"> &#x3C;/parent></span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#e1e4e8"> &#x3C;dependencies></span></div><div class="ec-line"><span style="--0:#e1e4e8">   &#x3C;dependency></span></div><div class="ec-line"><span style="--0:#e1e4e8">     &#x3C;groupId>com.alibaba.cloud&#x3C;/groupId></span></div><div class="ec-line"><span style="--0:#e1e4e8">     &#x3C;artifactId>spring-cloud-starter-ans&#x3C;/artifactId></span></div><div class="ec-line"><span style="--0:#e1e4e8">     &#x3C;version>1.1.3&#x3C;/version></span></div><div class="ec-line"><span style="--0:#e1e4e8">   &#x3C;/dependency></span></div><div class="ec-line"><span style="--0:#e1e4e8">   &#x3C;dependency></span></div><div class="ec-line"><span style="--0:#e1e4e8">     &#x3C;groupId>com.alibaba.cloud&#x3C;/groupId></span></div><div class="ec-line"><span style="--0:#e1e4e8">     &#x3C;artifactId>spring-cloud-alibaba-edas-starter&#x3C;/artifactId></span></div><div class="ec-line"><span style="--0:#e1e4e8">     &#x3C;version>1.1.3&#x3C;/version></span></div><div class="ec-line"><span style="--0:#e1e4e8">   &#x3C;/dependency></span></div><div class="ec-line"><span style="--0:#e1e4e8"> &#x3C;/dependencies></span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#e1e4e8"> &#x3C;dependencyManagement></span></div><div class="ec-line"><span style="--0:#e1e4e8">   &#x3C;dependencies></span></div><div class="ec-line"><span style="--0:#e1e4e8">     &#x3C;dependency></span></div><div class="ec-line"><span style="--0:#e1e4e8">       &#x3C;groupId>org.springframework.cloud&#x3C;/groupId></span></div><div class="ec-line"><span style="--0:#e1e4e8">       &#x3C;artifactId>spring-cloud-dependencies&#x3C;/artifactId></span></div><div class="ec-line"><span style="--0:#e1e4e8">       &#x3C;version>Dalston.SR4&#x3C;/version></span></div><div class="ec-line"><span style="--0:#e1e4e8">       &#x3C;type>pom&#x3C;/type></span></div><div class="ec-line"><span style="--0:#e1e4e8">       &#x3C;scope>import&#x3C;/scope></span></div><div class="ec-line"><span style="--0:#e1e4e8">     &#x3C;/dependency></span></div><div class="ec-line"><span style="--0:#e1e4e8">   &#x3C;/dependencies></span></div><div class="ec-line"><span style="--0:#e1e4e8"> &#x3C;/dependencyManagement></span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code=" <parent>   <groupId>org.springframework.boot</groupId>   <artifactId>spring-boot-starter-parent</artifactId>   <version>1.5.8.RELEASE</version>   <relativePath/> </parent> <dependencies>   <dependency>     <groupId>com.alibaba.cloud</groupId>     <artifactId>spring-cloud-starter-ans</artifactId>     <version>1.1.3</version>   </dependency>   <dependency>     <groupId>com.alibaba.cloud</groupId>     <artifactId>spring-cloud-alibaba-edas-starter</artifactId>     <version>1.1.3</version>   </dependency> </dependencies> <dependencyManagement>   <dependencies>     <dependency>       <groupId>org.springframework.cloud</groupId>       <artifactId>spring-cloud-dependencies</artifactId>       <version>Dalston.SR4</version>       <type>pom</type>       <scope>import</scope>     </dependency>   </dependencies> </dependencyManagement>"><div></div></button></div></figure></div>
<p>因为在这里我们要演示 FeignClient 的使用，所以与 service-provider 相比，pom.xml 文件中的依赖增加了一个 spring-cloud-starter-feign。</p>
</li>
<li>
<p>完成以下四个步骤，配置好 RestTemplate 、 AsyncRestTemplate 和 FeignClient。</p>
<ol>
<li>
<p>在使用 FeignClient 之前，我们还需要对它的配置，配置服务名以及方法对应的 HTTP 请求，示例代码如下</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#e1e4e8"> @FeignClient(name = "service-provider")</span></div><div class="ec-line"><span style="--0:#e1e4e8"> public interface EchoService {</span></div><div class="ec-line"><span style="--0:#e1e4e8">   @RequestMapping(value = "/echo/{str}", method = RequestMethod.GET)</span></div><div class="ec-line"><span style="--0:#e1e4e8">   String echo(@PathVariable("str") String str);</span></div><div class="ec-line"><span style="--0:#e1e4e8"> }</span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code=" @FeignClient(name = &#x22;service-provider&#x22;) public interface EchoService {   @RequestMapping(value = &#x22;/echo/{str}&#x22;, method = RequestMethod.GET)   String echo(@PathVariable(&#x22;str&#x22;) String str); }"><div></div></button></div></figure></div>
</li>
<li>
<p>在启动类中，使用 @EnableDiscoveryClient 注解启用服务注册与发现</p>
</li>
<li>
<p>在启动类中，使用 @EnableFeignClients 注解激活 FeignClient</p>
</li>
<li>
<p>在启动类中，添加 @LoadBalanced 注解将 RestTemplate 与 AsyncRestTemplate 与服务发现结合。</p>
</li>
</ol>
<p>最终启动类的代码如下</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#e1e4e8"> @SpringBootApplication</span></div><div class="ec-line"><span style="--0:#e1e4e8"> @EnableDiscoveryClient</span></div><div class="ec-line"><span style="--0:#e1e4e8"> @EnableFeignClients</span></div><div class="ec-line"><span style="--0:#e1e4e8"> public class ConsumerApplication {</span></div><div class="ec-line"><span style="--0:#e1e4e8">   @LoadBalanced</span></div><div class="ec-line"><span style="--0:#e1e4e8">   @Bean</span></div><div class="ec-line"><span style="--0:#e1e4e8">   public RestTemplate restTemplate() {</span></div><div class="ec-line"><span style="--0:#e1e4e8">     return new RestTemplate();</span></div><div class="ec-line"><span style="--0:#e1e4e8">   }</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#e1e4e8">   @LoadBalanced</span></div><div class="ec-line"><span style="--0:#e1e4e8">   @Bean</span></div><div class="ec-line"><span style="--0:#e1e4e8">   public AsyncRestTemplate asyncRestTemplate(){</span></div><div class="ec-line"><span style="--0:#e1e4e8">     return new AsyncRestTemplate();</span></div><div class="ec-line"><span style="--0:#e1e4e8">   }</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#e1e4e8">   public static void main(String[] args) {</span></div><div class="ec-line"><span style="--0:#e1e4e8">     SpringApplication.run(ConsumerApplication.class, args);</span></div><div class="ec-line"><span style="--0:#e1e4e8">   }</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#e1e4e8"> }</span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code=" @SpringBootApplication @EnableDiscoveryClient @EnableFeignClients public class ConsumerApplication {   @LoadBalanced   @Bean   public RestTemplate restTemplate() {     return new RestTemplate();   }   @LoadBalanced   @Bean   public AsyncRestTemplate asyncRestTemplate(){     return new AsyncRestTemplate();   }   public static void main(String[] args) {     SpringApplication.run(ConsumerApplication.class, args);   } }"><div></div></button></div></figure></div>
</li>
<li>
<p>创建一个Controller，供我们演示和验证服务发现功能使用。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#e1e4e8"> @RestController</span></div><div class="ec-line"><span style="--0:#e1e4e8"> public class TestController {</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#e1e4e8">     @Autowired</span></div><div class="ec-line"><span style="--0:#e1e4e8">     private RestTemplate restTemplate;</span></div><div class="ec-line"><span style="--0:#e1e4e8">     @Autowired</span></div><div class="ec-line"><span style="--0:#e1e4e8">     private AsyncRestTemplate asyncRestTemplate;</span></div><div class="ec-line"><span style="--0:#e1e4e8">     @Autowired</span></div><div class="ec-line"><span style="--0:#e1e4e8">     private  EchoService echoService;</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#e1e4e8">     @RequestMapping(value = "/echo-rest/{str}", method = RequestMethod.GET)</span></div><div class="ec-line"><span style="--0:#e1e4e8">     public String rest(@PathVariable String str) {</span></div><div class="ec-line"><span style="--0:#e1e4e8">         return restTemplate.getForObject("http://service-provider/echo/" + str, String.class);</span></div><div class="ec-line"><span style="--0:#e1e4e8">     }</span></div><div class="ec-line"><span style="--0:#e1e4e8">     @RequestMapping(value = "/echo-async-rest/{str}", method = RequestMethod.GET)</span></div><div class="ec-line"><span style="--0:#e1e4e8">     public String asyncRest(@PathVariable String str) throws Exception{</span></div><div class="ec-line"><span style="--0:#e1e4e8">         ListenableFuture&#x3C;ResponseEntity&#x3C;String>> future = asyncRestTemplate.</span></div><div class="ec-line"><span style="--0:#e1e4e8">                 getForEntity("http://service-provider/echo/"+str, String.class);</span></div><div class="ec-line"><span style="--0:#e1e4e8">         return future.get().getBody();</span></div><div class="ec-line"><span style="--0:#e1e4e8">     }</span></div><div class="ec-line"><span style="--0:#e1e4e8">     @RequestMapping(value = "/echo-feign/{str}", method = RequestMethod.GET)</span></div><div class="ec-line"><span style="--0:#e1e4e8">     public String feign(@PathVariable String str) {</span></div><div class="ec-line"><span style="--0:#e1e4e8">         return echoService.echo(str);</span></div><div class="ec-line"><span style="--0:#e1e4e8">     }</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#e1e4e8"> }</span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code=" @RestController public class TestController {     @Autowired     private RestTemplate restTemplate;     @Autowired     private AsyncRestTemplate asyncRestTemplate;     @Autowired     private  EchoService echoService;     @RequestMapping(value = &#x22;/echo-rest/{str}&#x22;, method = RequestMethod.GET)     public String rest(@PathVariable String str) {         return restTemplate.getForObject(&#x22;http://service-provider/echo/&#x22; + str, String.class);     }     @RequestMapping(value = &#x22;/echo-async-rest/{str}&#x22;, method = RequestMethod.GET)     public String asyncRest(@PathVariable String str) throws Exception{         ListenableFuture<ResponseEntity<String>> future = asyncRestTemplate.                 getForEntity(&#x22;http://service-provider/echo/&#x22;+str, String.class);         return future.get().getBody();     }     @RequestMapping(value = &#x22;/echo-feign/{str}&#x22;, method = RequestMethod.GET)     public String feign(@PathVariable String str) {         return echoService.echo(str);     } }"><div></div></button></div></figure></div>
</li>
<li>
<p>最后，添加应用基本配置和阿里云 AK、SK 以及 EDAS 的 namespace。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#e1e4e8"> spring.application.name=service-consumer</span></div><div class="ec-line"><span style="--0:#e1e4e8"> server.port=18082</span></div><div class="ec-line"><span style="--0:#e1e4e8"> alibaba.cloud.access-key=xxxxxxxxxx</span></div><div class="ec-line"><span style="--0:#e1e4e8"> alibaba.cloud.secret-key=xxxxxxxxxx</span></div><div class="ec-line"><span style="--0:#e1e4e8"> alibaba.edas.namespace=cn-hangzhou</span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code=" spring.application.name=service-consumer server.port=18082 alibaba.cloud.access-key=xxxxxxxxxx alibaba.cloud.secret-key=xxxxxxxxxx alibaba.edas.namespace=cn-hangzhou"><div></div></button></div></figure></div>
</li>
<li>
<p>启动服务，首先查看EDAS控制台，查询服务，可以看到，服务注册成功了。</p>
<p>再对我们的演示 API 分别进行调用，可以看到调用都成功了。
<img src="https://cdn.yuque.com/lark/0/2018/png/54319/1531104088354-7cc0fae7-95cf-4c62-a9ea-1b9a53908949.png" alt="5.png"></p>
<p><img src="https://cdn.yuque.com/lark/0/2018/png/54319/1531104133698-f9621e80-7cb1-4789-a88a-929f720b5c2b.png" alt="6.png"></p>
</li>
</ol>
<h2 id="demo-下载">Demo 下载</h2>
<p><a href="http://edas-public.oss-cn-hangzhou.aliyuncs.com/install_package/demo/ans-service-provider.zip" rel="noopener noreferrer" target="_blank">service-provider</a></p>
<p><a href="http://edas-public.oss-cn-hangzhou.aliyuncs.com/install_package/demo/ans-service-consumer.zip" rel="noopener noreferrer" target="_blank">service-consumer</a></p>
<h2 id="更多配置项">更多配置项</h2>




































































<table><thead><tr><th>配置项</th><th>key</th><th>默认值</th><th>说明</th><th>补充说明</th></tr></thead><tbody><tr><td>服务名</td><td>spring.cloud.ans.doms</td><td>spring.application.name</td><td>当此项未配置时，默认从spring.application.name中获取<br>需要发布多个服务时，中间用英文的 <code dir="auto">,</code> 号隔开</td><td>production</td></tr><tr><td>是否注册</td><td>spring.cloud.ans.register-enabled</td><td>true</td><td>当只需要发现，不需要注册时，可以通过将值设置成false来关闭注册</td><td>production</td></tr><tr><td>想要注册的IP</td><td>spring.cloud.ans.ip</td><td>无</td><td>当需要指定本机注册的IP时，通过此值来配置，优先级最高</td><td>production</td></tr><tr><td>想要注册的IP所属的网卡</td><td>spring.cloud.ans.interface-name</td><td>无</td><td>当确定需要发布哪块网卡对应的IP地址时，通过此参数配置，值为网卡名</td><td>production</td></tr><tr><td>想要注册的端口</td><td>spring.cloud.ans.port</td><td>无</td><td>想要注册的端口</td><td>production</td></tr><tr><td>注册的权重</td><td>spring.cloud.ans.weight</td><td>1</td><td>数值越大权重越高，取值范围为</td><td>test</td></tr><tr><td>集群</td><td>spring.cloud.ans.cluster</td><td>DEFAULT</td><td>可以通过集群来分别标记服务</td><td>test</td></tr><tr><td>租户环境</td><td>spring.cloud.ans.env</td><td>DEFAULT</td><td>相同租户的相同环境下的服务才能互相发现</td><td>test</td></tr></tbody></table>
<h2 id="工作原理">工作原理</h2>
<p>下面我们将从 服务注册中心寻址、服务注册与下线、客户端结合、高可用、安全等多个方面来分析原理。</p>
<h3 id="服务注册中心寻址">服务注册中心寻址</h3>
<p>配置阿里云的 AccessKey 和 SecretKey 之后，再指定 EDAS 的命名空间，那么程序会在启动的过程中去调用 EDAS 的接口，获取到此命名空间对应的账号权限信息和地址服务器的地址。</p>
<p>ANS 客户端通过地址服务器就能拿到 ANS Server端的地址。</p>
<h3 id="服务注册与下线">服务注册与下线</h3>
<p>服务注册的通信协议是 HTTP 协议，在 Spring 启动过程中，收到 EmbeddedServletContainerInitializedEvent 或 ServletWebServerInitializedEvent
事件时，会将服务注册到 ANS Server 端。</p>
<p>服务注册成功后，ANS client 端将会主动向 server 端发送心跳，当超过一定时间内 server 端没有收到 client 端的心跳时，会将服务标记成不可用，这样其他 client 在查询时就能发现此服务当前处于不可用的状态。<br>
如果短时间内，大量 client 与 server 心跳失败，则会出发降级保护机制，服务会暂时不被标记成不可用的状态。</p>
<p>当应用程序停止时，收到 ContextClosedEvent 事件后，ANS client 会调用 server 端的反注册接口，将此服务下线。</p>
<h3 id="客户端结合">客户端结合</h3>
<p>与客户端结合的方式， ans starter已经实现自动与 Ribbon 组件的结合。</p>
<p>Ribbon的关键接口有下面三个:</p>
<p>属性|提供的功能
---|---|---
ServerList  |提供 getInitialListOfServers 和 getUpdatedListOfServers 方法，获取和刷新 serverList。
IRule       |选择出一个服务节点
IPing       |提供 isAlive 方法，负责探测serverList中节点是否可用</p>
<p>目前 ans-starter 在 spring context 中默认实例化了一个 AnsServerList。AnsServerList 实现了 Ribbon 的 ServerList&#x3C;Server> 接口。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#e1e4e8">@Bean</span></div><div class="ec-line"><span style="--0:#e1e4e8">@ConditionalOnMissingBean</span></div><div class="ec-line"><span style="--0:#e1e4e8">public ServerList&#x3C;Server> ribbonServerList(IClientConfig config) {</span></div><div class="ec-line"><span style="--0:#e1e4e8">    AnsServerList serverList = new AnsServerList(config.getClientName());</span></div><div class="ec-line"><span style="--0:#e1e4e8">    return serverList;</span></div><div class="ec-line"><span style="--0:#e1e4e8">}</span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="@Bean@ConditionalOnMissingBeanpublic ServerList<Server> ribbonServerList(IClientConfig config) {    AnsServerList serverList = new AnsServerList(config.getClientName());    return serverList;}"><div></div></button></div></figure></div>
<p>如果您有其他需求，可以自行实现 Ribbon 的接口，或者直接在 github 上通过 issue 向我们提需求，我们评估通过后会加上此功能。</p>
<h3 id="高可用实现">高可用实现</h3>
<h4 id="服务端高可用">服务端高可用</h4>
<p>ANS作为分布式系统，服务端高可用包含以下几个方面：</p>
<ul>
<li>集群内机器数据对等，每台机器存储全量数据；</li>
<li>支持机房容灾功能，即一个集群中的某个机房内的机器全部挂掉不影响服务；</li>
<li>服务端异常自动探测，一旦某个机器挂了，该机器相关的任务（如健康检查）自动漂移到其他机器；</li>
</ul>
<h4 id="客户端高可用">客户端高可用</h4>
<p>ANS 为了保证高可用，在客户端高可用方面同样做了很多工作，以应对不同场景的异常情况。</p>
<ul>
<li>
<p>推空保护，当客户端收到服务端推送的空数据时，忽略掉该数据，使用上次的数据；</p>
</li>
<li>
<p>本地内存缓存，当运行时与服务注册中心的连接丢失或服务注册中心完全宕机，仍能正常地调用服务。</p>
</li>
<li>
<p>本地缓存文件，当应用与服务注册中心发生网络分区或服务注册中心完全宕机后，应用进行了重启操作，内存里没有数据，此时应用可以通过读取本地已落盘持久化的数据来获取到最后一次订阅到的内容。</p>
</li>
<li>
<p>本地容灾文件夹。正常的情况下，容灾文件夹内是没有内容的。当服务端完全宕机且长时间不能恢复，同时服务提供者又发生了很大的变更时，可以通过在容灾文件夹内添加文件的方式来开启本地容灾。此时客户端会忽略原有的本地缓存文件，只从本地容灾文件中读取配置。极端情况下，服务端完全不可用时，可以通过修改缓存文件的方式达到支持服务发布变更的目的。</p>
</li>
</ul>
<h3 id="安全的实现">安全的实现</h3>
<p>EDAS 服务注册发现组件，结合 EDAS 已有的安全功能，在每次注册、心跳和查询请求中都添加了验签鉴权的操作，保护了服务的安全性。</p>
<p>所以如果您发现您配置的权限信息都无误，但是运行文档中的 Demo 却注册失败了。则可能是由于您本机的时间不准确，从而导致验签鉴权失败。此时您需要校正本机的时间，建议打开时间自动同步功能。</p>
<h2 id="faq">FAQ</h2>
<h4 id="问为什么我的服务注册总是失败">问：为什么我的服务注册总是失败？</h4>
<h4 id="答如果您在确认账号信息都准确无误的情况下但是运行此文档中的-demo-却注册失败了有可能是由于您本机的时间不准确从而导致验签鉴权失败此时您需要校正本机的时间建议打开时间自动同步功能">答：如果您在确认账号信息都准确无误的情况下，但是运行此文档中的 Demo 却注册失败了。有可能是由于您本机的时间不准确，从而导致验签鉴权失败。此时您需要校正本机的时间，建议打开时间自动同步功能。</h4>  </div> </div>  </div> <div class="inline-block w-[30%] fixed bg-gray-14 h-full"> <aside> <div class="nav myroot prose"><ul>
<li>
<p><a href="#eureka-20-%E5%BC%80%E6%BA%90%E5%B7%A5%E4%BD%9C%E5%AE%A3%E5%91%8A%E5%81%9C%E6%AD%A2%E5%88%AB%E6%8B%85%E5%BF%83ans-%E5%8D%B3%E5%B0%86-c%E4%BD%8D%E5%BC%BA%E5%8A%BF%E5%87%BA%E9%81%93">Eureka 2.0 开源工作宣告停止？别担心，ANS 即将 C位强势出道！</a></p>
<ul>
<li>
<p><a href="#%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B">快速开始</a></p>
<ul>
<li><a href="#%E6%9C%8D%E5%8A%A1%E6%8F%90%E4%BE%9B%E8%80%85">服务提供者</a></li>
<li><a href="#%E6%9C%8D%E5%8A%A1%E6%B6%88%E8%B4%B9%E8%80%85">服务消费者</a></li>
</ul>
</li>
<li>
<p><a href="#demo-%E4%B8%8B%E8%BD%BD">Demo 下载</a></p>
</li>
<li>
<p><a href="#%E6%9B%B4%E5%A4%9A%E9%85%8D%E7%BD%AE%E9%A1%B9">更多配置项</a></p>
</li>
<li>
<p><a href="#%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86">工作原理</a></p>
<ul>
<li>
<p><a href="#%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83%E5%AF%BB%E5%9D%80">服务注册中心寻址</a></p>
</li>
<li>
<p><a href="#%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E4%B8%8E%E4%B8%8B%E7%BA%BF">服务注册与下线</a></p>
</li>
<li>
<p><a href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%BB%93%E5%90%88">客户端结合</a></p>
</li>
<li>
<p><a href="#%E9%AB%98%E5%8F%AF%E7%94%A8%E5%AE%9E%E7%8E%B0">高可用实现</a></p>
<ul>
<li><a href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%AB%98%E5%8F%AF%E7%94%A8">服务端高可用</a></li>
<li><a href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%AB%98%E5%8F%AF%E7%94%A8">客户端高可用</a></li>
</ul>
</li>
<li>
<p><a href="#%E5%AE%89%E5%85%A8%E7%9A%84%E5%AE%9E%E7%8E%B0">安全的实现</a></p>
</li>
</ul>
</li>
<li>
<p><a href="#faq">FAQ</a></p>
<ul>
<li>
<ul>
<li><a href="#%E9%97%AE%E4%B8%BA%E4%BB%80%E4%B9%88%E6%88%91%E7%9A%84%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E6%80%BB%E6%98%AF%E5%A4%B1%E8%B4%A5">问：为什么我的服务注册总是失败？</a></li>
<li><a href="#%E7%AD%94%E5%A6%82%E6%9E%9C%E6%82%A8%E5%9C%A8%E7%A1%AE%E8%AE%A4%E8%B4%A6%E5%8F%B7%E4%BF%A1%E6%81%AF%E9%83%BD%E5%87%86%E7%A1%AE%E6%97%A0%E8%AF%AF%E7%9A%84%E6%83%85%E5%86%B5%E4%B8%8B%E4%BD%86%E6%98%AF%E8%BF%90%E8%A1%8C%E6%AD%A4%E6%96%87%E6%A1%A3%E4%B8%AD%E7%9A%84-demo-%E5%8D%B4%E6%B3%A8%E5%86%8C%E5%A4%B1%E8%B4%A5%E4%BA%86%E6%9C%89%E5%8F%AF%E8%83%BD%E6%98%AF%E7%94%B1%E4%BA%8E%E6%82%A8%E6%9C%AC%E6%9C%BA%E7%9A%84%E6%97%B6%E9%97%B4%E4%B8%8D%E5%87%86%E7%A1%AE%E4%BB%8E%E8%80%8C%E5%AF%BC%E8%87%B4%E9%AA%8C%E7%AD%BE%E9%89%B4%E6%9D%83%E5%A4%B1%E8%B4%A5%E6%AD%A4%E6%97%B6%E6%82%A8%E9%9C%80%E8%A6%81%E6%A0%A1%E6%AD%A3%E6%9C%AC%E6%9C%BA%E7%9A%84%E6%97%B6%E9%97%B4%E5%BB%BA%E8%AE%AE%E6%89%93%E5%BC%80%E6%97%B6%E9%97%B4%E8%87%AA%E5%8A%A8%E5%90%8C%E6%AD%A5%E5%8A%9F%E8%83%BD">答：如果您在确认账号信息都准确无误的情况下，但是运行此文档中的 Demo 却注册失败了。有可能是由于您本机的时间不准确，从而导致验签鉴权失败。此时您需要校正本机的时间，建议打开时间自动同步功能。</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul></div> </aside> </div> </div>   </body> </html>